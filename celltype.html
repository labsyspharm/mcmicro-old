<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Assignment of cell type/state identity | Image Processing Pipeline</title>
  <meta name="description" content="5 Assignment of cell type/state identity | Image Processing Pipeline" />
  <meta name="generator" content="bookdown 0.15 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Assignment of cell type/state identity | Image Processing Pipeline" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="labsyspharm/mcmicro" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Assignment of cell type/state identity | Image Processing Pipeline" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="features.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<link rel="stylesheet" href="extra-styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">LSP Image Processing Pipeline</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Quick Start</a></li>
<li class="chapter" data-level="" data-path="individual-module-documentation.html"><a href="individual-module-documentation.html"><i class="fa fa-check"></i>Individual module documentation</a></li>
<li class="chapter" data-level="" data-path="howto.html"><a href="howto.html"><i class="fa fa-check"></i>How To Contribute</a><ul>
<li><a href="howto.html#forksync">Synchronizing your fork with <code>labsyspharm</code></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="pipeline.html"><a href="pipeline.html"><i class="fa fa-check"></i><b>1</b> End-to-end pipeline execution</a><ul>
<li class="chapter" data-level="1.1" data-path="pipeline.html"><a href="pipeline.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="pipeline.html"><a href="pipeline.html#usage"><i class="fa fa-check"></i><b>1.2</b> Usage</a><ul>
<li class="chapter" data-level="1.2.1" data-path="pipeline.html"><a href="pipeline.html#data-transfer"><i class="fa fa-check"></i><b>1.2.1</b> Data transfer</a></li>
<li class="chapter" data-level="1.2.2" data-path="pipeline.html"><a href="pipeline.html#go-to-the-working-directory"><i class="fa fa-check"></i><b>1.2.2</b> Go to the working directory</a></li>
<li class="chapter" data-level="1.2.3" data-path="pipeline.html"><a href="pipeline.html#generate-the-pipeline-execution-script"><i class="fa fa-check"></i><b>1.2.3</b> Generate the pipeline execution script</a></li>
<li class="chapter" data-level="1.2.4" data-path="pipeline.html"><a href="pipeline.html#launch-the-pipeline"><i class="fa fa-check"></i><b>1.2.4</b> Launch the pipeline</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="pipeline.html"><a href="pipeline.html#worked-example-using-a-sample-dataset"><i class="fa fa-check"></i><b>1.3</b> Worked example using a sample dataset</a></li>
<li class="chapter" data-level="1.4" data-path="pipeline.html"><a href="pipeline.html#results"><i class="fa fa-check"></i><b>1.4</b> Results</a></li>
<li class="chapter" data-level="1.5" data-path="pipeline.html"><a href="pipeline.html#visualize-images-on-omero"><i class="fa fa-check"></i><b>1.5</b> Visualize Images on Omero</a></li>
<li class="chapter" data-level="1.6" data-path="pipeline.html"><a href="pipeline.html#tips-and-tricks"><i class="fa fa-check"></i><b>1.6</b> Tips and Tricks</a><ul>
<li class="chapter" data-level="1.6.1" data-path="pipeline.html"><a href="pipeline.html#processing-your-own-data"><i class="fa fa-check"></i><b>1.6.1</b> Processing your own data</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="pipeline.html"><a href="pipeline.html#frequently-asked-questions-faq"><i class="fa fa-check"></i><b>1.7</b> Frequently Asked Questions (FAQ)</a><ul>
<li class="chapter" data-level="1.7.1" data-path="pipeline.html"><a href="pipeline.html#help-my-o2-environment-changed"><i class="fa fa-check"></i><b>1.7.1</b> Help my O2 environment changed!</a></li>
<li class="chapter" data-level="1.7.2" data-path="pipeline.html"><a href="pipeline.html#how-to-setup-o2-ssh-key"><i class="fa fa-check"></i><b>1.7.2</b> How To Setup O2 SSH Key</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="pipeline.html"><a href="pipeline.html#instructions-for-pipeline-module-developers"><i class="fa fa-check"></i><b>1.8</b> Instructions for pipeline module developers</a><ul>
<li class="chapter" data-level="1.8.1" data-path="pipeline.html"><a href="pipeline.html#install-run"><i class="fa fa-check"></i><b>1.8.1</b> Install &amp; Run</a></li>
<li class="chapter" data-level="1.8.2" data-path="pipeline.html"><a href="pipeline.html#building-the-conda-environments"><i class="fa fa-check"></i><b>1.8.2</b> Building the Conda Environments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="stitch.html"><a href="stitch.html"><i class="fa fa-check"></i><b>2</b> Image Stitching and Registration</a><ul>
<li class="chapter" data-level="2.1" data-path="stitch.html"><a href="stitch.html#input"><i class="fa fa-check"></i><b>2.1</b> Input</a></li>
<li class="chapter" data-level="2.2" data-path="stitch.html"><a href="stitch.html#output"><i class="fa fa-check"></i><b>2.2</b> Output</a></li>
<li class="chapter" data-level="2.3" data-path="stitch.html"><a href="stitch.html#installation-1"><i class="fa fa-check"></i><b>2.3</b> Installation</a></li>
<li class="chapter" data-level="2.4" data-path="stitch.html"><a href="stitch.html#usage-1"><i class="fa fa-check"></i><b>2.4</b> Usage</a><ul>
<li class="chapter" data-level="2.4.1" data-path="stitch.html"><a href="stitch.html#docker-container"><i class="fa fa-check"></i><b>2.4.1</b> Docker container</a></li>
<li class="chapter" data-level="2.4.2" data-path="stitch.html"><a href="stitch.html#instructions-python"><i class="fa fa-check"></i><b>2.4.2</b> Native Python</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="stitch.html"><a href="stitch.html#example"><i class="fa fa-check"></i><b>2.5</b> Example</a></li>
<li class="chapter" data-level="2.6" data-path="stitch.html"><a href="stitch.html#more-details"><i class="fa fa-check"></i><b>2.6</b> More details</a></li>
<li class="chapter" data-level="2.7" data-path="stitch.html"><a href="stitch.html#references"><i class="fa fa-check"></i><b>2.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="segment.html"><a href="segment.html"><i class="fa fa-check"></i><b>3</b> Image Segmentation</a><ul>
<li class="chapter" data-level="3.1" data-path="segment.html"><a href="segment.html#preprocess"><i class="fa fa-check"></i><b>3.1</b> Image Preprocessing</a></li>
<li class="chapter" data-level="3.2" data-path="segment.html"><a href="segment.html#binarize"><i class="fa fa-check"></i><b>3.2</b> Probability map binarization</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>4</b> Extract spatial single cell features</a></li>
<li class="chapter" data-level="5" data-path="celltype.html"><a href="celltype.html"><i class="fa fa-check"></i><b>5</b> Assignment of cell type/state identity</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Image Processing Pipeline</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="celltype" class="section level1">
<h1><span class="header-section-number">5</span> Assignment of cell type/state identity</h1>
<p>Once segmentation masks have been <a href="features.html#features">quantified</a>, the resulting cell-by-marker matrices can be used to assign cell type/state identity to individual cells. Methods to do this generally fall into two categories. The first set of methods typically begin by clustering cells into distinct subpopulations. The clusters are then inspected for the expression of specific markers, and cell type/state labeles are assigned to all cells belonging to that cluster. More sophisticated methods allow for “soft” assignment of cells to multiple clusters at once, which produces probabilistic assignment of cell types/states.</p>
<p>The second class of methods forgo clustering entirely and work directly with the cell-by-marker matrix on a per-row (i.e., per-cell) basis. In the presence of labels, cell type assignment becomes a standard supervised learning task, where a model can be learned from labeled cells and applied to classify unlabeled ones. In the absence of labels, cell type assignment requires some prior knowledge about which markers map to which cell types/states. Given this mapping, assignment of cell identity can be done directly from marker expression.</p>
<p><strong>Expected input:</strong></p>
<ul>
<li>An n-by-p matrix of <code>n</code> cells (rows) with quantified expression across <code>p</code> markers (columns)</li>
<li>[optional] An n-by-1 vector of labels obtained through, e.g., manual curation</li>
<li>[optional] A k-by-2 matrix that maps <code>k</code> channels to the corresponding cell type</li>
</ul>
<p><strong>Expected output:</strong></p>
<ul>
<li>An n-by-(p+1) matrix that encapsulates the original data with a new additional column denoting cell type assignments made by the method. In the case of probabilistic assigment, the method may output additional columns specifying per-class probabilities.</li>
</ul>
<p><strong>Clustering-based methods</strong></p>
<p><strong>Traditional supervised learning</strong></p>
<p><strong>Method employing prior knowledge</strong></p>
<ul>
<li><p><a href="https://github.com/labsyspharm/naivestates">naivestates</a> - Inference of cell states using a Naive Bayes framework. The method models each channel / marker as a mixture of two Gaussians. The resulting posterior probabilities of marker expression are combined with a pre-defined marker -&gt; cell type/state mapping to arrive at probabilistic assignment of cells to classes.</p></li>
<li><p><a href="https://github.com/labsyspharm/IMAAP">IMAAP</a> - Cell type annotation and analysis of multiplexed imaging data. The method models each marker as a mixture of two Gaussians and assigns a probability to the regions of uncertainty (where the gaussians intersect) to account for common segmentation errors. The assigned probabilities are then used to determine which cell type / state to which each cell belongs using a combination of user-defined markers. The method also includes data analysis and visualization functions.</p></li>
</ul>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="features.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"github": true
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
